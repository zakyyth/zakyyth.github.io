<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Laanqari Aisha High School</title>
  <style>
    /* ===== Reset & Base ===== */
    * {margin:0; padding:0; box-sizing:border-box;}
    html {scroll-behavior: smooth;}
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(180deg, #f4f4f9, #e2e4f5);
      color: #333;
      line-height: 1.6;
    }

    /* ===== Login Page ===== */
    .login-container {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      background: linear-gradient(135deg, #2a2d8f, #4446b1);
      position: relative;
      overflow: hidden;
    }
    .login-container::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
      background-size: 50px 50px;
      animation: backgroundMove 20s linear infinite;
    }
    @keyframes backgroundMove {
      0% {transform: translate(0, 0);}
      100% {transform: translate(50px, 50px);}
    }
    .login-box {
      background: white;
      padding: 50px 40px;
      border-radius: 20px;
      box-shadow: 0 15px 50px rgba(0,0,0,0.3);
      max-width: 450px;
      width: 90%;
      position: relative;
      z-index: 1;
      animation: slideUp 0.6s ease-out;
    }
    @keyframes slideUp {
      from {opacity: 0; transform: translateY(30px);}
      to {opacity: 1; transform: translateY(0);}
    }
    .login-header {
      text-align: center;
      margin-bottom: 35px;
    }
    .login-header h1 {
      color: #2a2d8f;
      font-size: 2em;
      margin-bottom: 10px;
    }
    .login-header p {
      color: #666;
      font-size: 1em;
    }
    .login-icon {
      font-size: 4em;
      margin-bottom: 20px;
    }
    .form-group {
      margin-bottom: 25px;
      position: relative;
    }
    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: #2a2d8f;
      font-weight: 600;
      font-size: 0.95em;
    }
    .form-group input, .form-group textarea {
      width: 100%;
      padding: 14px 15px 14px 45px;
      border: 2px solid #ddd;
      border-radius: 10px;
      font-size: 1em;
      transition: all 0.3s;
      background: #f9f9f9;
    }
    .form-group textarea {
      padding: 14px 15px;
      resize: vertical;
      min-height: 100px;
    }
    .form-group input:focus, .form-group textarea:focus {
      outline: none;
      border-color: #2a2d8f;
      box-shadow: 0 0 15px rgba(42,45,143,0.2);
      background: white;
    }
    .form-group .icon {
      position: absolute;
      left: 15px;
      top: 42px;
      font-size: 1.2em;
      color: #2a2d8f;
    }
    .login-btn, .btn-primary {
      width: 100%;
      padding: 15px;
      border: none;
      border-radius: 10px;
      background: linear-gradient(135deg, #2a2d8f, #4446b1);
      color: white;
      font-size: 1.1em;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 4px 15px rgba(42,45,143,0.4);
    }
    .login-btn:hover, .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(42,45,143,0.5);
    }
    .login-btn:active, .btn-primary:active {
      transform: translateY(0);
    }
    .user-type-selector {
      display: flex;
      gap: 10px;
      margin-bottom: 25px;
    }
    .user-type-btn {
      flex: 1;
      padding: 12px;
      border: 2px solid #ddd;
      background: white;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s;
      font-weight: 600;
      color: #666;
    }
    .user-type-btn.active {
      border-color: #2a2d8f;
      background: linear-gradient(135deg, #2a2d8f, #4446b1);
      color: white;
    }
    .user-type-btn:hover {
      border-color: #4446b1;
    }
    .login-footer {
      text-align: center;
      margin-top: 25px;
      color: #666;
      font-size: 0.9em;
    }
    .login-footer a {
      color: #2a2d8f;
      text-decoration: none;
      font-weight: 600;
    }
    .login-footer a:hover {
      text-decoration: underline;
    }
    .error-message {
      background: #f8d7da;
      color: #721c24;
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 20px;
      border: 1px solid #f5c6cb;
      display: none;
      animation: shake 0.5s;
    }
    @keyframes shake {
      0%, 100% {transform: translateX(0);}
      25% {transform: translateX(-10px);}
      75% {transform: translateX(10px);}
    }
    .success-message {
      background: #d4edda;
      color: #155724;
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 20px;
      border: 1px solid #c3e6cb;
      display: none;
    }
    .info-message {
      background: #d1ecf1;
      color: #0c5460;
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 20px;
      border: 1px solid #bee5eb;
      font-size: 0.9em;
    }

    /* ===== Main Website Styles ===== */
    .main-website {
      display: none;
    }
    header {
      background: linear-gradient(135deg, #2a2d8f, #4446b1);
      color: white;
      padding: 30px 20px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    header::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
      background-size: 50px 50px;
      animation: backgroundMove 20s linear infinite;
    }
    header h1 {
      font-size:2.5em;
      position: relative;
      animation: fadeInDown 1s ease-out;
    }
    header p {
      font-size:1.1em; 
      opacity:0.9;
      position: relative;
      animation: fadeInUp 1s ease-out;
    }
    .user-info {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(255,255,255,0.2);
      padding: 10px 20px;
      border-radius: 25px;
      backdrop-filter: blur(10px);
      z-index: 10;
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .user-info span {
      font-weight: bold;
    }
    .logout-btn {
      background: white;
      color: #2a2d8f;
      border: none;
      padding: 6px 15px;
      border-radius: 15px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s;
    }
    .logout-btn:hover {
      background: #f0f0f0;
      transform: scale(1.05);
    }
    
    /* ===== Notification Badge ===== */
    .notification-badge {
      position: relative;
      display: inline-block;
      margin-left: 10px;
    }
    .notification-count {
      position: absolute;
      top: -8px;
      right: -8px;
      background: #ff4444;
      color: white;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.7em;
      font-weight: bold;
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    
    @keyframes fadeInDown {
      from {opacity: 0; transform: translateY(-30px);}
      to {opacity: 1; transform: translateY(0);}
    }
    @keyframes fadeInUp {
      from {opacity: 0; transform: translateY(30px);}
      to {opacity: 1; transform: translateY(0);}
    }

    /* ===== Navigation ===== */
    nav {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      background: #4446b1;
      position: sticky;
      top: 0;
      z-index: 1000;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
    }
    nav a {
      color: white;
      padding: 16px 28px;
      text-decoration: none;
      font-weight: bold;
      transition: all 0.3s;
      position: relative;
      cursor: pointer;
    }
    nav a.active {
      background: rgba(255,255,255,0.2);
      border-bottom: 3px solid white;
    }
    nav a:hover {
      background: rgba(255,255,255,0.1);
    }

    /* ===== Main Content ===== */
    main {padding: 30px 20px; max-width: 1100px; margin: auto; min-height: calc(100vh - 300px);}
    .page {
      display: none;
      animation: fadeIn 0.5s ease-out;
    }
    .page.active {
      display: block;
    }
    @keyframes fadeIn {
      from {opacity: 0; transform: translateY(20px);}
      to {opacity: 1; transform: translateY(0);}
    }
    
    h2 {
      color: #2a2d8f;
      border-bottom: 3px solid #2a2d8f;
      padding-bottom: 10px;
      margin-bottom: 25px;
      font-size: 2em;
      display: inline-block;
    }

    /* ===== Cards ===== */
    .card {
      background: white;
      padding: 25px;
      margin: 15px 0;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      border-radius: 15px;
      transition: all 0.4s;
      border-left: 5px solid #2a2d8f;
      position: relative;
      overflow: hidden;
    }
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(42,45,143,0.3);
    }
    .card h3 {
      color: #2a2d8f;
      margin-bottom: 10px;
      font-size: 1.4em;
    }
    .card p {
      color: #555;
      line-height: 1.7;
    }
    .card .badge {
      display: inline-block;
      background: #2a2d8f;
      color: white;
      padding: 5px 12px;
      border-radius: 20px;
      font-size: 0.8em;
      margin-top: 10px;
      margin-right: 5px;
    }
    .card-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid #eee;
      font-size: 0.9em;
      color: #666;
    }
    .card-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }
    .btn-small {
      padding: 8px 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s;
      font-size: 0.9em;
    }
    .btn-like {
      background: #e8f4fd;
      color: #2a8fdb;
    }
    .btn-like:hover {
      background: #2a8fdb;
      color: white;
    }
    .btn-like.liked {
      background: #2a8fdb;
      color: white;
    }
    .btn-comment {
      background: #fff3cd;
      color: #856404;
    }
    .btn-comment:hover {
      background: #856404;
      color: white;
    }
    .btn-delete {
      background: #f8d7da;
      color: #721c24;
    }
    .btn-delete:hover {
      background: #721c24;
      color: white;
    }

    /* ===== Add Content Button ===== */
    .add-content-btn {
      position: fixed;
      bottom: 30px;
      right: 30px;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: linear-gradient(135deg, #2a2d8f, #4446b1);
      color: white;
      border: none;
      font-size: 2em;
      cursor: pointer;
      box-shadow: 0 4px 20px rgba(42,45,143,0.5);
      transition: all 0.3s;
      z-index: 100;
    }
    .add-content-btn:hover {
      transform: scale(1.1) rotate(90deg);
      box-shadow: 0 6px 30px rgba(42,45,143,0.7);
    }

    /* ===== Stats ===== */
    .stats-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin: 30px 0;
    }
    .stat-box {
      background: white;
      padding: 25px;
      border-radius: 15px;
      text-align: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      transition: all 0.3s;
    }
    .stat-box:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(42,45,143,0.3);
    }
    .stat-number {
      font-size: 2.5em;
      font-weight: bold;
      color: #2a2d8f;
      margin-bottom: 10px;
    }
    .stat-label {
      color: #666;
      font-size: 1em;
    }

    /* ===== Modal ===== */
    .modal {
      display: none;
      position: fixed;
      z-index: 2000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.7);
      animation: fadeIn 0.3s;
    }
    .modal-content {
      background: white;
      margin: 3% auto;
      padding: 30px;
      border-radius: 15px;
      max-width: 600px;
      max-height: 85vh;
      overflow-y: auto;
      animation: slideDown 0.4s;
      position: relative;
    }
    @keyframes slideDown {
      from {opacity: 0; transform: translateY(-50px);}
      to {opacity: 1; transform: translateY(0);}
    }
    .close {
      position: absolute;
      right: 20px;
      top: 15px;
      font-size: 28px;
      font-weight: bold;
      color: #aaa;
      cursor: pointer;
      transition: color 0.3s;
    }
    .close:hover {
      color: #2a2d8f;
    }

    /* ===== Comments Section ===== */
    .comments-section {
      margin-top: 20px;
      padding: 15px;
      background: #f9f9f9;
      border-radius: 10px;
      display: none;
    }
    .comments-section.active {
      display: block;
    }
    .comment {
      background: white;
      padding: 12px;
      margin: 10px 0;
      border-radius: 8px;
      border-left: 3px solid #2a2d8f;
    }
    .comment-author {
      font-weight: bold;
      color: #2a2d8f;
      margin-bottom: 5px;
    }
    .comment-text {
      color: #555;
    }
    .comment-time {
      font-size: 0.8em;
      color: #999;
      margin-top: 5px;
    }
    .comment-input {
      width: 100%;
      padding: 10px;
      border: 2px solid #ddd;
      border-radius: 8px;
      margin-top: 10px;
    }

    /* ===== Notifications Panel ===== */
    .notification-item {
      background: white;
      padding: 15px;
      margin: 10px 0;
      border-radius: 10px;
      border-left: 4px solid #2a2d8f;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      transition: all 0.3s;
    }
    .notification-item:hover {
      transform: translateX(5px);
      box-shadow: 0 4px 12px rgba(42,45,143,0.2);
    }
    .notification-item.unread {
      background: #e8f4fd;
      border-left-color: #2a8fdb;
    }
    .notification-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }
    .notification-type {
      font-weight: bold;
      color: #2a2d8f;
    }
    .notification-time {
      font-size: 0.85em;
      color: #999;
    }
    .notification-message {
      color: #555;
      line-height: 1.5;
    }
    .mark-read-btn {
      margin-top: 10px;
      padding: 6px 12px;
      background: #2a2d8f;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.85em;
      transition: all 0.3s;
    }
    .mark-read-btn:hover {
      background: #4446b1;
    }
    .clear-all-btn {
      padding: 10px 20px;
      background: #f8d7da;
      color: #721c24;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      margin-bottom: 20px;
      transition: all 0.3s;
    }
    .clear-all-btn:hover {
      background: #721c24;
      color: white;
    }

    /* ===== Storage Info Box ===== */
    .storage-info {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 20px;
      border-radius: 15px;
      margin-bottom: 25px;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
    }
    .storage-info h4 {
      margin-bottom: 10px;
      font-size: 1.2em;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .storage-info p {
      opacity: 0.95;
      line-height: 1.6;
      font-size: 0.95em;
    }
    .storage-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin-top: 15px;
    }
    .storage-stat {
      background: rgba(255,255,255,0.2);
      padding: 12px;
      border-radius: 10px;
      text-align: center;
      backdrop-filter: blur(10px);
    }
    .storage-stat-value {
      font-size: 1.8em;
      font-weight: bold;
      margin-bottom: 5px;
    }
    .storage-stat-label {
      font-size: 0.85em;
      opacity: 0.9;
    }

    /* ===== Footer ===== */
    footer {
      text-align: center;
      padding: 30px;
      background: linear-gradient(135deg, #2a2d8f, #4446b1);
      color: white;
      margin-top: 50px;
      box-shadow: 0 -4px 15px rgba(0,0,0,0.2);
    }
    footer p {
      margin: 10px 0;
    }

    /* ===== Responsive ===== */
    @media (max-width: 768px) {
      header h1 {font-size: 1.8em;}
      nav a {padding: 12px 15px; font-size: 0.9em;}
      .user-info {position: static; margin: 10px; justify-content: center;}
      .add-content-btn {width: 50px; height: 50px; font-size: 1.5em;}
    }
  </style>
</head>
<body>

<!-- ===== Login Page ===== -->
<div id="loginPage" class="login-container">
  <div class="login-box">
    <div class="login-header">
      <div class="login-icon">üéì</div>
      <h1>Welcome Back!</h1>
      <p>Laanqari Aisha High School Portal</p>
      <div class="info-message" style="margin-top: 15px;">
        üíæ <strong>Persistent Storage Active</strong><br>
        Your data is automatically saved and will persist across sessions on this device.
      </div>
    </div>
    
    <div class="user-type-selector">
      <button class="user-type-btn active" onclick="selectUserType('student')">
        üë®‚Äçüéì Student
      </button>
      <button class="user-type-btn" onclick="selectUserType('teacher')">
        üë©‚Äçüè´ Teacher
      </button>
      <button class="user-type-btn" onclick="selectUserType('admin')">
        üîê Admin
      </button>
    </div>

    <div id="errorMessage" class="error-message"></div>
    <div id="successMessage" class="success-message"></div>

    <form id="loginForm" onsubmit="handleLogin(event)">
      <div class="form-group">
        <label for="username">Username</label>
        <span class="icon">üë§</span>
        <input type="text" id="username" name="username" placeholder="Enter your username" required>
      </div>

      <div class="form-group">
        <label for="password">Password</label>
        <span class="icon">üîí</span>
        <input type="password" id="password" name="password" placeholder="Enter your password" required>
      </div>

      <button type="submit" class="login-btn">üöÄ Sign In</button>
    </form>

    <div class="login-footer">
      <p><a href="#" onclick="showForgotPassword()">Forgot Password?</a> | 
         <a href="#" onclick="showRegisterPage()">Create Account</a></p>
    </div>
  </div>
</div>

<!-- ===== Registration Page ===== -->
<div id="registerPage" class="login-container" style="display:none;">
  <div class="login-box">
    <div class="login-header">
      <div class="login-icon">üìù</div>
      <h1>Create Account</h1>
      <p>Join Laanqari Aisha High School Portal</p>
    </div>
    
    <div class="user-type-selector">
      <button class="user-type-btn active" onclick="selectRegisterType('student')">
        üë®‚Äçüéì Student
      </button>
      <button class="user-type-btn" onclick="selectRegisterType('teacher')">
        üë©‚Äçüè´ Teacher
      </button>
    </div>

    <div id="registerError" class="error-message"></div>
    <div id="registerSuccess" class="success-message"></div>

    <form id="registerForm" onsubmit="handleRegister(event)">
      <div class="form-group">
        <label for="regFullName">Full Name</label>
        <span class="icon">üë§</span>
        <input type="text" id="regFullName" placeholder="Enter your full name" required>
      </div>

      <div class="form-group">
        <label for="regEmail">Email</label>
        <span class="icon">‚úâÔ∏è</span>
        <input type="email" id="regEmail" placeholder="Enter your email" required>
      </div>

      <div class="form-group">
        <label for="regUsername">Username</label>
        <span class="icon">üë§</span>
        <input type="text" id="regUsername" placeholder="Choose a username" required minlength="4">
      </div>

      <div class="form-group">
        <label for="regPassword">Password</label>
        <span class="icon">üîí</span>
        <input type="password" id="regPassword" placeholder="Choose a password" required minlength="6">
      </div>

      <div class="form-group">
        <label for="regConfirmPassword">Confirm Password</label>
        <span class="icon">üîí</span>
        <input type="password" id="regConfirmPassword" placeholder="Confirm your password" required>
      </div>

      <div class="form-group" id="studentIdGroup">
        <label for="regStudentId">Student ID</label>
        <span class="icon">üéì</span>
        <input type="text" id="regStudentId" placeholder="e.g., 2026001, STU12345">
      </div>

      <div class="form-group" id="teacherCodeGroup" style="display:none;">
        <label for="regTeacherCode">Teacher Access Code</label>
        <span class="icon">üîê</span>
        <input type="text" id="regTeacherCode" placeholder="Enter teacher access code">
      </div>

      <button type="submit" class="login-btn">‚ú® Create Account</button>
    </form>

    <div class="login-footer">
      <p>Already have an account? <a href="#" onclick="showLoginPage()">Sign In</a></p>
      <p style="font-size: 0.85em; color: #999; margin-top: 10px;">
        Teacher Access Code: TEACH2026
      </p>
    </div>
  </div>
</div>

<!-- ===== Main Website ===== -->
<div id="mainWebsite" class="main-website">
  <header>
    <div class="user-info">
      <span id="userDisplay">üë§ Guest</span>
      <button class="logout-btn" onclick="logout()">Logout</button>
    </div>
    <h1>üéì Laanqari Aisha High School</h1>
    <p>Excellence in Education Since 2000</p>
  </header>

  <nav>
    <a onclick="navigateTo('home')" class="active">üè† Home</a>
    <a onclick="navigateTo('news')">üì∞ News</a>
    <a onclick="navigateTo('students')">üë®‚Äçüéì Students</a>
    <a onclick="navigateTo('teachers')">üë©‚Äçüè´ Teachers</a>
    <a onclick="navigateTo('contact')">üìß Contact</a>
    <a id="notificationsTab" onclick="navigateTo('notifications')" style="display:none;">
      üîî Notifications
      <span class="notification-badge">
        <span id="notificationCount" class="notification-count" style="display:none;">0</span>
      </span>
    </a>
  </nav>

  <main>
    <!-- ===== Home Page ===== -->
    <div id="homePage" class="page active">
      <h2>Welcome to Our School</h2>
      <div class="stats-container">
        <div class="stat-box">
          <div class="stat-number" data-target="850">850</div>
          <div class="stat-label">Students</div>
        </div>
        <div class="stat-box">
          <div class="stat-number" data-target="45">45</div>
          <div class="stat-label">Teachers</div>
        </div>
        <div class="stat-box">
          <div class="stat-number" data-target="98">98</div>
          <div class="stat-label">Success Rate %</div>
        </div>
        <div class="stat-box">
          <div class="stat-number" data-target="26">26</div>
          <div class="stat-label">Years Established</div>
        </div>
      </div>

      <div class="card">
        <h3>üéì About Our School</h3>
        <p>Laanqari Aisha High School has been a beacon of excellence in education since 2000. We provide a nurturing environment where students can grow academically, socially, and personally.</p>
        <span class="badge">Established 2000</span>
        <span class="badge">Excellence</span>
      </div>

      <div class="card">
        <h3>üèÜ Our Mission</h3>
        <p>To empower students with knowledge, skills, and values that prepare them for success in an ever-changing world.</p>
      </div>
    </div>

    <!-- ===== News Page ===== -->
    <div id="newsPage" class="page">
      <h2>School News & Events</h2>
      <div id="newsContent"></div>
    </div>

    <!-- ===== Students Page ===== -->
    <div id="studentsPage" class="page">
      <h2>Our Students</h2>
      <div id="studentsContent"></div>
    </div>

    <!-- ===== Teachers Page ===== -->
    <div id="teachersPage" class="page">
      <h2>Our Teachers</h2>
      <div id="teachersContent"></div>
    </div>

    <!-- ===== Contact Page ===== -->
    <div id="contactPage" class="page">
      <h2>Contact Us</h2>
      <div class="card">
        <h3>üìç School Address</h3>
        <p>Laanqari Aisha High School<br>
        Chlef Taougrit, Algeria</p>
      </div>
      <div class="card">
        <h3>üìû Contact Information</h3>
        <p>Phone: +213-0557522486<br>
        Email: info@laanqarischool.edu.dz</p>
      </div>
      <div class="card">
        <h3>üìß Send us a Message</h3>
        <form onsubmit="handleContactSubmit(event)">
          <div class="form-group">
            <label for="contactName">Name</label>
            <input type="text" id="contactName" required>
          </div>
          <div class="form-group">
            <label for="contactEmail">Email</label>
            <input type="email" id="contactEmail" required>
          </div>
          <div class="form-group">
            <label for="contactMessage">Message</label>
            <textarea id="contactMessage" required></textarea>
          </div>
          <button type="submit" class="btn-primary">Send Message</button>
        </form>
        <div id="contactFormMessage" class="success-message" style="margin-top: 15px;"></div>
      </div>
    </div>

    <!-- ===== Notifications Page (Admin Only) ===== -->
    <div id="notificationsPage" class="page">
      <h2>Admin Notifications</h2>
      
      <!-- Storage Information -->
      <div class="storage-info">
        <h4>üíæ Storage Information</h4>
        <p>All data is persistently stored in your browser's local storage. Data will be maintained across sessions on this device.</p>
        <div class="storage-stats">
          <div class="storage-stat">
            <div class="storage-stat-value" id="totalUsers">0</div>
            <div class="storage-stat-label">Total Users</div>
          </div>
          <div class="storage-stat">
            <div class="storage-stat-value" id="totalPosts">0</div>
            <div class="storage-stat-label">Total Posts</div>
          </div>
          <div class="storage-stat">
            <div class="storage-stat-value" id="totalNotifications">0</div>
            <div class="storage-stat-label">Notifications</div>
          </div>
          <div class="storage-stat">
            <div class="storage-stat-value" id="storageSize">0 KB</div>
            <div class="storage-stat-label">Storage Used</div>
          </div>
        </div>
      </div>
      
      <button class="clear-all-btn" onclick="clearAllNotifications()">üóëÔ∏è Clear All Notifications</button>
      
      <div id="notificationsContent"></div>
    </div>
  </main>

  <!-- Add Content Button (Only for Teachers and Admins) -->
  <button id="addContentBtn" class="add-content-btn" onclick="showAddContentModal()" style="display:none;">+</button>

  <!-- ===== Add Content Modal ===== -->
  <div id="addContentModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeAddContentModal()">&times;</span>
      <h2>Create New Post</h2>
      <form id="addContentForm" onsubmit="handleAddContent(event)">
        <div class="form-group">
          <label for="postCategory">Category</label>
          <select id="postCategory" style="width:100%; padding:12px; border:2px solid #ddd; border-radius:8px;" required>
            <option value="news">News & Events</option>
            <option value="students">Students</option>
            <option value="teachers">Teachers</option>
          </select>
        </div>
        <div class="form-group">
          <label for="postTitle">Title</label>
          <input type="text" id="postTitle" required>
        </div>
        <div class="form-group">
          <label for="postContent">Content</label>
          <textarea id="postContent" rows="5" required></textarea>
        </div>
        <div class="form-group">
          <label for="postMedia">üì∑ Add Photo or Video (Optional)</label>
          <input type="file" id="postMedia" accept="image/*,video/*" onchange="previewMedia(event)" style="width:100%; padding:12px; border:2px solid #ddd; border-radius:8px; background:#f9f9f9;">
          <div id="mediaPreview" style="margin-top:15px; display:none;">
            <p style="font-weight:bold; color:#2a2d8f; margin-bottom:10px;">Preview:</p>
            <img id="imagePreview" style="max-width:100%; max-height:300px; border-radius:10px; display:none;">
            <video id="videoPreview" controls style="max-width:100%; max-height:300px; border-radius:10px; display:none;"></video>
            <button type="button" onclick="removeMedia()" style="margin-top:10px; padding:8px 16px; background:#f8d7da; color:#721c24; border:none; border-radius:8px; cursor:pointer;">‚ùå Remove Media</button>
          </div>
        </div>
        <div class="form-group">
          <label for="postTags">Tags (comma separated)</label>
          <input type="text" id="postTags" placeholder="e.g., Important, Upcoming, Featured">
        </div>
        <button type="submit" class="btn-primary">üì§ Post</button>
      </form>
    </div>
  </div>

  <footer>
    <p>&copy; 2026 Laanqari Aisha High School</p>
    <p>üìç Chlef Taougrit, Algeria | üìû +213-0557522486 | ‚úâÔ∏è info@laanqarischool.edu.dz</p>
  </footer>
</div>

<!-- ===== JavaScript ===== -->
<script>
  // ===== STORAGE MANAGER =====
  // Centralized storage system for all data persistence
  const StorageManager = {
    // Storage keys
    KEYS: {
      USERS: 'laanqari_users',
      POSTS: 'laanqari_posts',
      NOTIFICATIONS: 'laanqari_notifications',
      SESSION: 'laanqari_session',
      INITIALIZED: 'laanqari_initialized'
    },

    // Initialize storage with default data if first time
    initialize() {
      const isInitialized = localStorage.getItem(this.KEYS.INITIALIZED);
      
      if (!isInitialized) {
        // First time setup
        this.save(this.KEYS.USERS, []);
        this.save(this.KEYS.POSTS, this.getDefaultPosts());
        this.save(this.KEYS.NOTIFICATIONS, []);
        localStorage.setItem(this.KEYS.INITIALIZED, 'true');
        console.log('‚úÖ Storage initialized with default data');
      } else {
        console.log('‚úÖ Storage already initialized');
      }
    },

    // Save data to localStorage
    save(key, data) {
      try {
        localStorage.setItem(key, JSON.stringify(data));
        return true;
      } catch (error) {
        console.error('Storage save error:', error);
        return false;
      }
    },

    // Load data from localStorage
    load(key, defaultValue = null) {
      try {
        const data = localStorage.getItem(key);
        return data ? JSON.parse(data) : defaultValue;
      } catch (error) {
        console.error('Storage load error:', error);
        return defaultValue;
      }
    },

    // Remove data from localStorage
    remove(key) {
      localStorage.removeItem(key);
    },

    // Get storage size in KB
    getStorageSize() {
      let total = 0;
      for (let key in localStorage) {
        if (localStorage.hasOwnProperty(key)) {
          total += localStorage[key].length + key.length;
        }
      }
      return (total / 1024).toFixed(2);
    },

    // Clear all app data (except initialization flag)
    clearAll() {
      this.remove(this.KEYS.USERS);
      this.remove(this.KEYS.POSTS);
      this.remove(this.KEYS.NOTIFICATIONS);
      this.remove(this.KEYS.SESSION);
      this.remove(this.KEYS.INITIALIZED);
      console.log('üóëÔ∏è All storage cleared');
    },

    // Get default posts for initialization
    getDefaultPosts() {
      return [
        {
          id: Date.now() + 1,
          category: 'news',
          title: 'üî¨ Science Fair 2026',
          content: 'The annual science fair will take place on March 10. Students from all grades are encouraged to participate and showcase their innovative projects!',
          tags: ['Upcoming', 'Important'],
          author: 'Admin',
          date: new Date('2026-01-25').toISOString(),
          likes: 15,
          likedBy: [],
          comments: []
        },
        {
          id: Date.now() + 2,
          category: 'news',
          title: '‚öΩ Sports Day',
          content: 'Our school Sports Day is scheduled for April 5. Join us for a day full of fun competitions, team spirit, and athletic excellence!',
          tags: ['April 2026', 'Sports'],
          author: 'Teacher',
          date: new Date('2026-01-28').toISOString(),
          likes: 23,
          likedBy: [],
          comments: []
        },
        {
          id: Date.now() + 3,
          category: 'students',
          title: '‚≠ê Emma Zaki',
          content: 'Top student in mathematics and computer science projects. Winner of the 2025 Regional Coding Competition.',
          tags: ['Mathematics', 'Computer Science'],
          author: 'Admin',
          date: new Date('2026-01-20').toISOString(),
          likes: 42,
          likedBy: [],
          comments: []
        },
        {
          id: Date.now() + 4,
          category: 'teachers',
          title: 'üë©‚Äçüè´ Mrs. Aisha Laanqari',
          content: 'Mathematics Teacher with 15 years of experience. Holder of the National Teaching Excellence Award.',
          tags: ['15 Years Experience', 'Mathematics'],
          author: 'Admin',
          date: new Date('2026-01-15').toISOString(),
          likes: 56,
          likedBy: [],
          comments: []
        }
      ];
    }
  };

  // ===== DATA LAYER =====
  // Manages all data operations
  const DataManager = {
    // Get all users
    getUsers() {
      return StorageManager.load(StorageManager.KEYS.USERS, []);
    },

    // Save users
    saveUsers(users) {
      return StorageManager.save(StorageManager.KEYS.USERS, users);
    },

    // Add new user
    addUser(user) {
      const users = this.getUsers();
      users.push(user);
      return this.saveUsers(users);
    },

    // Get all posts
    getPosts() {
      return StorageManager.load(StorageManager.KEYS.POSTS, []);
    },

    // Save posts
    savePosts(posts) {
      return StorageManager.save(StorageManager.KEYS.POSTS, posts);
    },

    // Add new post
    addPost(post) {
      const posts = this.getPosts();
      posts.unshift(post);
      return this.savePosts(posts);
    },

    // Update post
    updatePost(postId, updates) {
      const posts = this.getPosts();
      const index = posts.findIndex(p => p.id === postId);
      if (index !== -1) {
        posts[index] = { ...posts[index], ...updates };
        return this.savePosts(posts);
      }
      return false;
    },

    // Delete post
    deletePost(postId) {
      const posts = this.getPosts().filter(p => p.id !== postId);
      return this.savePosts(posts);
    },

    // Get all notifications
    getNotifications() {
      return StorageManager.load(StorageManager.KEYS.NOTIFICATIONS, []);
    },

    // Save notifications
    saveNotifications(notifications) {
      return StorageManager.save(StorageManager.KEYS.NOTIFICATIONS, notifications);
    },

    // Add notification
    addNotification(notification) {
      const notifications = this.getNotifications();
      notifications.unshift(notification);
      return this.saveNotifications(notifications);
    },

    // Clear all notifications
    clearNotifications() {
      return this.saveNotifications([]);
    },

    // Get session
    getSession() {
      return StorageManager.load(StorageManager.KEYS.SESSION, null);
    },

    // Save session
    saveSession(session) {
      return StorageManager.save(StorageManager.KEYS.SESSION, session);
    },

    // Clear session
    clearSession() {
      return StorageManager.remove(StorageManager.KEYS.SESSION);
    },

    // Get storage statistics
    getStats() {
      return {
        users: this.getUsers().length,
        posts: this.getPosts().length,
        notifications: this.getNotifications().length,
        storageSize: StorageManager.getStorageSize()
      };
    }
  };

  // ===== APPLICATION STATE =====
  let currentUser = null;
  let userType = 'student';
  let registerType = 'student';
  let currentPage = 'home';
  let currentMediaData = null;
  let currentMediaType = null;

  // Default valid credentials
  const validCredentials = {
    student: { username: 'student', password: 'student123' },
    teacher: { username: 'teacher', password: 'teacher123' },
    admin: { username: 'admin', password: 'admin123' }
  };

  // ===== AUTHENTICATION FUNCTIONS =====
  function selectUserType(type) {
    userType = type;
    document.querySelectorAll('#loginPage .user-type-btn').forEach(btn => {
      btn.classList.remove('active');
    });
    event.target.classList.add('active');
  }

  function selectRegisterType(type) {
    registerType = type;
    document.querySelectorAll('#registerPage .user-type-btn').forEach(btn => {
      btn.classList.remove('active');
    });
    event.target.classList.add('active');

    if (type === 'student') {
      document.getElementById('studentIdGroup').style.display = 'block';
      document.getElementById('teacherCodeGroup').style.display = 'none';
      document.getElementById('regStudentId').required = true;
      document.getElementById('regTeacherCode').required = false;
    } else {
      document.getElementById('studentIdGroup').style.display = 'none';
      document.getElementById('teacherCodeGroup').style.display = 'block';
      document.getElementById('regStudentId').required = false;
      document.getElementById('regTeacherCode').required = true;
    }
  }

  function showRegisterPage() {
    document.getElementById('loginPage').style.display = 'none';
    document.getElementById('registerPage').style.display = 'flex';
    document.getElementById('registerError').style.display = 'none';
    document.getElementById('registerSuccess').style.display = 'none';
  }

  function showLoginPage() {
    document.getElementById('registerPage').style.display = 'none';
    document.getElementById('loginPage').style.display = 'flex';
    document.getElementById('errorMessage').style.display = 'none';
    document.getElementById('successMessage').style.display = 'none';
  }

  function showForgotPassword() {
    alert('Please contact the school administrator at admin@laanqarischool.edu.dz to reset your password.');
  }

  function handleRegister(event) {
    event.preventDefault();
    
    const fullName = document.getElementById('regFullName').value;
    const email = document.getElementById('regEmail').value;
    const username = document.getElementById('regUsername').value;
    const password = document.getElementById('regPassword').value;
    const confirmPassword = document.getElementById('regConfirmPassword').value;
    const studentId = document.getElementById('regStudentId').value;
    const teacherCode = document.getElementById('regTeacherCode').value;
    
    const errorMsg = document.getElementById('registerError');
    const successMsg = document.getElementById('registerSuccess');
    
    errorMsg.style.display = 'none';
    successMsg.style.display = 'none';

    if (password !== confirmPassword) {
      errorMsg.textContent = '‚ùå Passwords do not match!';
      errorMsg.style.display = 'block';
      return;
    }

    if (password.length < 6) {
      errorMsg.textContent = '‚ùå Password must be at least 6 characters long!';
      errorMsg.style.display = 'block';
      return;
    }

    const users = DataManager.getUsers();
    const existingUser = users.find(u => u.username === username);
    
    if (existingUser || username === 'student' || username === 'teacher' || username === 'admin') {
      errorMsg.textContent = '‚ùå Username already exists! Please choose another one.';
      errorMsg.style.display = 'block';
      return;
    }

    if (registerType === 'teacher' && teacherCode !== 'TEACH2026') {
      errorMsg.textContent = '‚ùå Invalid teacher access code!';
      errorMsg.style.display = 'block';
      return;
    }

    const newUser = {
      fullName: fullName,
      email: email,
      username: username,
      password: password,
      type: registerType,
      studentId: registerType === 'student' ? studentId : null,
      createdAt: new Date().toISOString()
    };

    DataManager.addUser(newUser);

    // Send notification to admin
    addNotification(
      'New Registration',
      `New ${registerType} registered: ${fullName} (${username})`,
      { username: username, type: registerType, email: email }
    );

    successMsg.textContent = `‚úÖ Account created successfully! Welcome ${fullName}! Redirecting to login...`;
    successMsg.style.display = 'block';

    document.getElementById('registerForm').reset();
    
    setTimeout(() => {
      showLoginPage();
      document.getElementById('username').value = username;
    }, 2000);
  }

  function handleLogin(event) {
    event.preventDefault();
    
    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;
    const errorMsg = document.getElementById('errorMessage');
    const successMsg = document.getElementById('successMessage');
    
    errorMsg.style.display = 'none';
    successMsg.style.display = 'none';

    // Check default credentials
    const credentials = validCredentials[userType];
    
    if (username === credentials.username && password === credentials.password) {
      currentUser = {
        username: username,
        type: userType,
        displayName: userType.charAt(0).toUpperCase() + userType.slice(1),
        fullName: userType.charAt(0).toUpperCase() + userType.slice(1) + ' User'
      };
      
      addNotification(
        'New Login',
        `${currentUser.fullName} (${userType}) logged in`,
        { username: username, type: userType }
      );
      
      successMsg.textContent = `‚úÖ Welcome ${currentUser.displayName}! Redirecting...`;
      successMsg.style.display = 'block';
      
      DataManager.saveSession(currentUser);
      
      setTimeout(() => {
        showMainWebsite();
      }, 1500);
      return;
    }

    // Check registered users
    const users = DataManager.getUsers();
    const registeredUser = users.find(u => 
      u.username === username && u.password === password && u.type === userType
    );

    if (registeredUser) {
      currentUser = {
        username: registeredUser.username,
        type: registeredUser.type,
        displayName: registeredUser.type.charAt(0).toUpperCase() + registeredUser.type.slice(1),
        fullName: registeredUser.fullName,
        email: registeredUser.email
      };
      
      addNotification(
        'New Login',
        `${registeredUser.fullName} (${registeredUser.type}) logged in`,
        { username: username, type: registeredUser.type, email: registeredUser.email }
      );
      
      successMsg.textContent = `‚úÖ Welcome back ${registeredUser.fullName}! Redirecting...`;
      successMsg.style.display = 'block';
      
      DataManager.saveSession(currentUser);
      
      setTimeout(() => {
        showMainWebsite();
      }, 1500);
    } else {
      errorMsg.textContent = '‚ùå Invalid username or password. Please try again.';
      errorMsg.style.display = 'block';
    }
  }

  function logout() {
    if (confirm('Are you sure you want to logout?')) {
      if (window.notificationInterval) {
        clearInterval(window.notificationInterval);
      }
      
      currentUser = null;
      DataManager.clearSession();
      
      document.getElementById('mainWebsite').style.display = 'none';
      document.getElementById('loginPage').style.display = 'flex';
      document.getElementById('loginForm').reset();
      document.getElementById('addContentBtn').style.display = 'none';
      document.getElementById('notificationsTab').style.display = 'none';
    }
  }

  function showMainWebsite() {
    document.getElementById('loginPage').style.display = 'none';
    document.getElementById('registerPage').style.display = 'none';
    document.getElementById('mainWebsite').style.display = 'block';
    
    const userIcon = currentUser.type === 'admin' ? 'üîê' : 
                     currentUser.type === 'teacher' ? 'üë©‚Äçüè´' : 'üë®‚Äçüéì';
    
    document.getElementById('userDisplay').textContent = `${userIcon} ${currentUser.fullName}`;
    
    // Show add content button for teachers and admins
    if (currentUser.type === 'teacher' || currentUser.type === 'admin') {
      document.getElementById('addContentBtn').style.display = 'block';
    }

    // Show notifications tab for admin
    if (currentUser.type === 'admin') {
      document.getElementById('notificationsTab').style.display = 'inline-block';
      updateNotificationBadge();
      
      // Auto-refresh notifications every 3 seconds
      if (window.notificationInterval) {
        clearInterval(window.notificationInterval);
      }
      window.notificationInterval = setInterval(() => {
        updateNotificationBadge();
        if (currentPage === 'notifications') {
          renderNotifications();
        }
      }, 3000);
    }
    
    renderPage(currentPage);
  }

  // ===== NOTIFICATION FUNCTIONS =====
  function addNotification(type, message, relatedData = {}) {
    const notification = {
      id: Date.now(),
      type: type,
      message: message,
      timestamp: new Date().toISOString(),
      read: false,
      relatedData: relatedData
    };
    
    DataManager.addNotification(notification);
    updateNotificationBadge();
  }

  function updateNotificationBadge() {
    if (currentUser && currentUser.type === 'admin') {
      const notifications = DataManager.getNotifications();
      const unreadCount = notifications.filter(n => !n.read).length;
      const badge = document.getElementById('notificationCount');
      
      if (badge) {
        if (unreadCount > 0) {
          badge.textContent = unreadCount;
          badge.style.display = 'flex';
        } else {
          badge.style.display = 'none';
        }
      }
    }
  }

  function markNotificationAsRead(notificationId) {
    const notifications = DataManager.getNotifications();
    const notification = notifications.find(n => n.id === notificationId);
    
    if (notification) {
      notification.read = true;
      DataManager.saveNotifications(notifications);
      updateNotificationBadge();
      renderNotifications();
    }
  }

  function clearAllNotifications() {
    if (confirm('Are you sure you want to clear all notifications?')) {
      DataManager.clearNotifications();
      updateNotificationBadge();
      renderNotifications();
    }
  }

  function renderNotifications() {
    const notifications = DataManager.getNotifications();
    const container = document.getElementById('notificationsContent');
    
    // Update storage stats
    const stats = DataManager.getStats();
    document.getElementById('totalUsers').textContent = stats.users;
    document.getElementById('totalPosts').textContent = stats.posts;
    document.getElementById('totalNotifications').textContent = stats.notifications;
    document.getElementById('storageSize').textContent = stats.storageSize + ' KB';
    
    if (notifications.length === 0) {
      container.innerHTML = '<div class="card"><p>No notifications yet.</p></div>';
      return;
    }

    container.innerHTML = notifications.map(notif => `
      <div class="notification-item ${notif.read ? '' : 'unread'}">
        <div class="notification-header">
          <span class="notification-type">${getNotificationIcon(notif.type)} ${notif.type}</span>
          <span class="notification-time">${formatTimeAgo(notif.timestamp)}</span>
        </div>
        <div class="notification-message">${notif.message}</div>
        ${!notif.read ? `<button class="mark-read-btn" onclick="markNotificationAsRead(${notif.id})">‚úì Mark as Read</button>` : ''}
      </div>
    `).join('');
    
    updateNotificationBadge();
  }

  function getNotificationIcon(type) {
    const icons = {
      'New Login': 'üîì',
      'New Registration': 'üë§',
      'New Post': 'üìù',
      'New Comment': 'üí¨',
      'New Message': '‚úâÔ∏è',
      'Post Deleted': 'üóëÔ∏è'
    };
    return icons[type] || 'üìå';
  }

  function formatTimeAgo(timestamp) {
    const now = new Date();
    const time = new Date(timestamp);
    const diff = Math.floor((now - time) / 1000);

    if (diff < 60) return 'Just now';
    if (diff < 3600) return `${Math.floor(diff / 60)} minutes ago`;
    if (diff < 86400) return `${Math.floor(diff / 3600)} hours ago`;
    if (diff < 604800) return `${Math.floor(diff / 86400)} days ago`;
    return time.toLocaleDateString();
  }

  // ===== NAVIGATION FUNCTIONS =====
  function navigateTo(page) {
    currentPage = page;
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.querySelectorAll('nav a').forEach(a => a.classList.remove('active'));
    
    document.getElementById(page + 'Page').classList.add('active');
    event.target.classList.add('active');
    
    renderPage(page);
  }

  function renderPage(page) {
    if (page === 'news') {
      renderPosts('news', 'newsContent');
    } else if (page === 'students') {
      renderPosts('students', 'studentsContent');
    } else if (page === 'teachers') {
      renderPosts('teachers', 'teachersContent');
    } else if (page === 'notifications') {
      renderNotifications();
    }
  }

  // ===== POST FUNCTIONS =====
  function renderPosts(category, containerId) {
    const posts = DataManager.getPosts();
    const container = document.getElementById(containerId);
    const categoryPosts = posts.filter(p => p.category === category)
                               .sort((a, b) => new Date(b.date) - new Date(a.date));
    
    if (categoryPosts.length === 0) {
      container.innerHTML = '<div class="card"><p>No posts yet. Teachers and admins can add content!</p></div>';
      return;
    }
    
    container.innerHTML = categoryPosts.map(post => {
      const isLiked = post.likedBy && post.likedBy.includes(currentUser?.username);
      const canDelete = currentUser && (currentUser.type === 'admin' || post.author === currentUser.fullName);
      
      return `
        <div class="card" id="post-${post.id}">
          <h3>${post.title}</h3>
          <p>${post.content}</p>
          ${post.mediaData ? (post.mediaType.startsWith('image') ? 
            `<img src="${post.mediaData}" style="max-width:100%; max-height:400px; border-radius:10px; margin:15px 0;">` : 
            `<video controls style="max-width:100%; max-height:400px; border-radius:10px; margin:15px 0;">
              <source src="${post.mediaData}" type="${post.mediaType}">
            </video>`) : ''}
          ${post.tags.map(tag => `<span class="badge">${tag}</span>`).join('')}
          <div class="card-meta">
            <span>üìù By ${post.author} | üìÖ ${new Date(post.date).toLocaleDateString()}</span>
            <span>‚ù§Ô∏è ${post.likes} | üí¨ ${post.comments.length}</span>
          </div>
          <div class="card-actions">
            <button class="btn-small btn-like ${isLiked ? 'liked' : ''}" onclick="toggleLike(${post.id})">
              ${isLiked ? '‚ù§Ô∏è Liked' : 'ü§ç Like'}
            </button>
            <button class="btn-small btn-comment" onclick="toggleComments(${post.id})">
              üí¨ Comment (${post.comments.length})
            </button>
            ${canDelete ? `<button class="btn-small btn-delete" onclick="deletePost(${post.id})">üóëÔ∏è Delete</button>` : ''}
          </div>
          <div class="comments-section" id="comments-${post.id}">
            <div id="comments-list-${post.id}">
              ${post.comments.map(c => `
                <div class="comment">
                  <div class="comment-author">${c.author}</div>
                  <div class="comment-text">${c.text}</div>
                  <div class="comment-time">${formatTimeAgo(c.date)}</div>
                </div>
              `).join('')}
            </div>
            <input type="text" class="comment-input" id="comment-input-${post.id}" placeholder="Write a comment...">
            <button class="btn-small btn-comment" style="margin-top:10px;" onclick="addComment(${post.id})">Post Comment</button>
          </div>
        </div>
      `;
    }).join('');
  }

  function toggleLike(postId) {
    if (!currentUser) return;
    
    const posts = DataManager.getPosts();
    const post = posts.find(p => p.id === postId);
    if (!post) return;
    
    if (!post.likedBy) post.likedBy = [];
    if (!post.likes) post.likes = 0;
    
    const index = post.likedBy.indexOf(currentUser.username);
    if (index > -1) {
      post.likedBy.splice(index, 1);
      post.likes--;
    } else {
      post.likedBy.push(currentUser.username);
      post.likes++;
    }
    
    DataManager.savePosts(posts);
    renderPage(currentPage);
  }

  function toggleComments(postId) {
    const commentsSection = document.getElementById(`comments-${postId}`);
    commentsSection.classList.toggle('active');
  }

  function addComment(postId) {
    if (!currentUser) return;
    
    const input = document.getElementById(`comment-input-${postId}`);
    const text = input.value.trim();
    
    if (!text) return;
    
    const posts = DataManager.getPosts();
    const post = posts.find(p => p.id === postId);
    if (!post) return;
    
    if (!post.comments) post.comments = [];
    
    const newComment = {
      author: currentUser.fullName,
      text: text,
      date: new Date().toISOString()
    };
    
    post.comments.push(newComment);
    
    addNotification(
      'New Comment',
      `${currentUser.fullName} commented on "${post.title}": "${text.substring(0, 50)}${text.length > 50 ? '...' : ''}"`,
      { postId: postId, postTitle: post.title, commentText: text }
    );
    
    DataManager.savePosts(posts);
    input.value = '';
    renderPage(currentPage);
  }

  function deletePost(postId) {
    if (!confirm('Are you sure you want to delete this post?')) return;
    
    const posts = DataManager.getPosts();
    const post = posts.find(p => p.id === postId);
    const postTitle = post ? post.title : 'Unknown Post';
    
    DataManager.deletePost(postId);
    
    addNotification(
      'Post Deleted',
      `${currentUser.fullName} deleted post: "${postTitle}"`,
      { postId: postId, postTitle: postTitle }
    );
    
    renderPage(currentPage);
  }

  // ===== MODAL FUNCTIONS =====
  function showAddContentModal() {
    document.getElementById('addContentModal').style.display = 'block';
  }

  function closeAddContentModal() {
    document.getElementById('addContentModal').style.display = 'none';
    document.getElementById('addContentForm').reset();
    removeMedia();
  }

  function previewMedia(event) {
    const file = event.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    
    reader.onload = function(e) {
      currentMediaData = e.target.result;
      currentMediaType = file.type;
      
      const preview = document.getElementById('mediaPreview');
      const imagePreview = document.getElementById('imagePreview');
      const videoPreview = document.getElementById('videoPreview');
      
      preview.style.display = 'block';
      
      if (file.type.startsWith('image/')) {
        imagePreview.src = e.target.result;
        imagePreview.style.display = 'block';
        videoPreview.style.display = 'none';
      } else if (file.type.startsWith('video/')) {
        videoPreview.src = e.target.result;
        videoPreview.style.display = 'block';
        imagePreview.style.display = 'none';
      }
    };
    
    reader.readAsDataURL(file);
  }

  function removeMedia() {
    currentMediaData = null;
    currentMediaType = null;
    document.getElementById('postMedia').value = '';
    document.getElementById('mediaPreview').style.display = 'none';
    document.getElementById('imagePreview').src = '';
    document.getElementById('videoPreview').src = '';
  }

  function handleAddContent(event) {
    event.preventDefault();
    
    if (!currentUser || (currentUser.type !== 'teacher' && currentUser.type !== 'admin')) {
      alert('Only teachers and admins can post content!');
      return;
    }
    
    const category = document.getElementById('postCategory').value;
    const title = document.getElementById('postTitle').value;
    const content = document.getElementById('postContent').value;
    const tags = document.getElementById('postTags').value.split(',').map(t => t.trim()).filter(t => t);
    
    const newPost = {
      id: Date.now(),
      category: category,
      title: title,
      content: content,
      tags: tags,
      author: currentUser.fullName,
      date: new Date().toISOString(),
      likes: 0,
      likedBy: [],
      comments: [],
      mediaData: currentMediaData,
      mediaType: currentMediaType
    };
    
    DataManager.addPost(newPost);
    
    addNotification(
      'New Post',
      `${currentUser.fullName} created a new post in ${category}: "${title}"`,
      { postId: newPost.id, category: category, title: title }
    );
    
    closeAddContentModal();
    
    // Navigate to the category page
    if (category === 'news') navigateTo('news');
    else if (category === 'students') navigateTo('students');
    else if (category === 'teachers') navigateTo('teachers');
  }

  // ===== CONTACT FORM =====
  function handleContactSubmit(event) {
    event.preventDefault();
    
    const name = document.getElementById('contactName').value;
    const email = document.getElementById('contactEmail').value;
    const message = document.getElementById('contactMessage').value;
    
    addNotification(
      'New Message',
      `Contact form message from ${name} (${email}): "${message.substring(0, 50)}${message.length > 50 ? '...' : ''}"`,
      { name: name, email: email, message: message }
    );
    
    const msg = document.getElementById('contactFormMessage');
    msg.textContent = '‚úÖ Message sent successfully! We will get back to you soon.';
    msg.style.display = 'block';
    event.target.reset();
    
    setTimeout(() => {
      msg.style.display = 'none';
    }, 5000);
  }

  // ===== INITIALIZATION =====
  window.addEventListener('DOMContentLoaded', function() {
    // Initialize storage
    StorageManager.initialize();
    
    // Check for existing session
    const savedSession = DataManager.getSession();
    if (savedSession) {
      currentUser = savedSession;
      showMainWebsite();
    }
  });

  // Close modal when clicking outside
  window.onclick = function(event) {
    const modal = document.getElementById('addContentModal');
    if (event.target == modal) {
      closeAddContentModal();
    }
  }
</script>

</body>
</html>
